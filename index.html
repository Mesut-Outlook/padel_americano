<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Padel Americano — Fixture & Scoreboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-900">
  <div id="root"></div>

  <!-- React 18 UMD -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <script type="module">
    const { useEffect, useMemo, useState } = React;

    // --- Data --------------------------------------------------------------
    // Players will be loaded from players.json
    const [PLAYERS, setPLAYERS] = (() => {
      // tiny local state shim before React state: we'll replace with React state below
      return [null, null];
    })();

    // Dynamic fixture generator for given players, 2 courts, 3 weeks x 3 slots
    function generateFixture(players, weeks = 3, slotsPerWeek = 3, courts = ["Saha 1","Saha 2"]) {
      const n = players.length;
      const perSlotCapacity = courts.length * 4; // 2 courts * 4 players
      const waitCount = Math.max(0, n - perSlotCapacity);
      const out = [];
      for (let w = 1; w <= weeks; w++) {
        for (let s = 1; s <= slotsPerWeek; s++) {
          const slotIndex = (w - 1) * slotsPerWeek + (s - 1);
          // rotate waiters
          const waiters = [];
          for (let k = 0; k < waitCount; k++) {
            waiters.push(players[(slotIndex * waitCount + k) % n]);
          }
          // available players for this slot
          const available = players.filter((p) => !waiters.includes(p));
          // simple rotation to vary a bit across slots
          const rot = slotIndex % available.length;
          const rotated = available.slice(rot).concat(available.slice(0, rot));
          for (let c = 0; c < courts.length; c++) {
            const base = c * 4;
            const t1 = [rotated[base], rotated[base + 1]];
            const t2 = [rotated[base + 2], rotated[base + 3]];
            out.push({
              week: w,
              slot: s,
              court: courts[c],
              t1,
              t2,
              wait: waiters.join(" & "),
            });
          }
        }
      }
      return out;
    }

  // We'll create FIXTURE after players are loaded
  let FIXTURE = [];

    // --- Helpers -----------------------------------------------------------
  const KEY_POINTS = "americano_points_v3";
  const KEY_MATCHES = "americano_matches_v3";
  const KEY_CONFIG = "americano_config_v1";
  const KEY_PLAYERS_OVERRIDE = "americano_players_override_v1";

    function useLocalStorage(key, initialValue) {
      const [state, setState] = useState(() => {
        try {
          const item = window.localStorage.getItem(key);
          return item ? JSON.parse(item) : initialValue;
        } catch (e) { return initialValue; }
      });
      useEffect(() => {
        try { window.localStorage.setItem(key, JSON.stringify(state)); } catch (e) {}
      }, [key, state]);
      return [state, setState];
    }

    function clamp(n, min, max) {
      return Math.max(min, Math.min(max, n));
    }

    // --- Main Component ----------------------------------------------------
    function App() {
      const [players, setPlayers] = useState(null);
      const [fixture, setFixture] = useState([]);
      const [activeWeek, setActiveWeek] = useState(1);
    const [points, setPoints] = useLocalStorage(KEY_POINTS, {});
      const [matches, setMatches] = useLocalStorage(KEY_MATCHES, {});
  const [config, setConfig] = useLocalStorage(KEY_CONFIG, { weeks: 5, slotsPerWeek: 3, courts: ["Saha 1","Saha 2"] });
      const [playersOverride, setPlayersOverride] = useLocalStorage(KEY_PLAYERS_OVERRIDE, null);
      const [showAdmin, setShowAdmin] = useState(false);
      const [plText, setPlText] = useState("");
      const [courtsText, setCourtsText] = useState("");
      const [newPlayer, setNewPlayer] = useState("");
      const [courtCount, setCourtCount] = useState(Array.isArray(config.courts) ? config.courts.length : 2);
    const [activeSlot, setActiveSlot] = useState("all");
    const [activeCourt, setActiveCourt] = useState("all");

      useEffect(() => {
        let mounted = true;
        const load = async () => {
          if (Array.isArray(playersOverride) && playersOverride.length > 0) return playersOverride;
          const r = await fetch('players.json');
          return await r.json();
        };
        load()
          .then((list) => {
            if (!mounted) return;
            setPlayers(list);
            setFixture(generateFixture(list, config.weeks, config.slotsPerWeek, config.courts));
            // initialize points if empty
            setPoints((prev) => {
              const hasAny = prev && Object.keys(prev).length > 0;
              if (hasAny) return prev;
              return Object.fromEntries(list.map((p) => [p, 0]));
            });
          })
          .catch(() => {
            // fallback: if fetch fails, use a default 10 list to avoid blank
            const fallback = ["Mesut","Berk","Mumtaz","Ahmet","Erdem","Sercan","Sezgin","Batuhan","Emre","Okan"];
            setPlayers(fallback);
            setFixture(generateFixture(fallback, config.weeks, config.slotsPerWeek, config.courts));
            setPoints((prev) => {
              const hasAny = prev && Object.keys(prev).length > 0;
              if (hasAny) return prev;
              return Object.fromEntries(fallback.map((p) => [p, 0]));
            });
          });
        return () => { mounted = false; };
      }, [playersOverride, config.weeks, config.slotsPerWeek, config.courts]);

      useEffect(() => { if (players) setPlText(players.join("\n")); }, [players]);
      useEffect(() => { if (config) setCourtsText((config.courts || []).join(", ")); }, [config]);
      useEffect(() => { if (players) setFixture(generateFixture(players, config.weeks, config.slotsPerWeek, config.courts)); }, [players, config]);
      useEffect(() => { setCourtCount(Array.isArray(config.courts) ? config.courts.length : 2); }, [config]);

      const parsedPlayers = useMemo(() => {
        return Array.from(new Set((plText || "").split(/\r?\n/).map(s => s.trim()).filter(Boolean)));
      }, [plText]);

      // Load config.json as global default if no local override exists
      useEffect(() => {
        try { if (window.localStorage.getItem(KEY_CONFIG)) return; } catch (e) {}
        (async () => {
          try {
            const r = await fetch('config.json');
            if (!r.ok) return;
            const cfg = await r.json();
            if (!cfg) return;
            const weeks = Number(cfg.weeks) || 5;
            const slotsPerWeek = Number(cfg.slotsPerWeek) || 3;
            const courts = Array.isArray(cfg.courts) ? cfg.courts.filter(Boolean) : ["Saha 1","Saha 2"];
            setConfig({ weeks, slotsPerWeek, courts });
          } catch (e) {}
        })();
      }, []);

  const weekList = useMemo(() => Array.from(new Set(fixture.map((m) => m.week))), [fixture]);
      const slotList = useMemo(() => {
        const list = fixture.filter((m) => m.week === activeWeek).map(m => m.slot);
        return Array.from(new Set(list)).sort((a,b)=>a-b);
      }, [fixture, activeWeek]);
      useEffect(() => { setActiveSlot("all"); setActiveCourt("all"); }, [activeWeek, config.courts]);
      const filtered = useMemo(() => {
        return fixture
          .filter((m) => m.week === activeWeek)
          .filter((m) => (activeSlot === "all" ? true : m.slot === Number(activeSlot)))
          .filter((m) => (activeCourt === "all" ? true : m.court === activeCourt))
          .sort((a, b) => a.slot - b.slot || a.court.localeCompare(b.court));
      }, [activeWeek, fixture, activeSlot, activeCourt]);

      const autoAward = useMemo(() => {
        if (!players) return {};
        const award = Object.fromEntries(players.map((p) => [p, 0]));
        for (const m of fixture) {
          const key = `${m.week}-${m.slot}-${m.court}`;
          const rec = matches[key];
          if (!rec) continue;
          const t1 = clamp(Number(rec.t1) || 0, 0, 32);
          const t2 = clamp(Number(rec.t2) || 0, 0, 32);
          for (const p of m.t1) award[p] += t1;
          for (const p of m.t2) award[p] += t2;
          if (t1 === 32 && t2 <= 31) {
            for (const p of m.t1) award[p] += 10;
          } else if (t2 === 32 && t1 <= 31) {
            for (const p of m.t2) award[p] += 10;
          }
        }
        return award;
      }, [matches, players, fixture]);

      const leaderboard = useMemo(() => {
        if (!players) return [];
        const rows = players.map((p) => ({
          player: p,
          manual: points[p] || 0,
          auto: autoAward[p] || 0,
          total: (points[p] || 0) + (autoAward[p] || 0),
        }));
        rows.sort((a, b) => b.total - a.total || a.player.localeCompare(b.player));
        return rows;
      }, [points, autoAward, players]);

      // Opponent diversity: unique opponents each player faces across current fixture
      const uniqueOpponents = useMemo(() => {
        if (!players) return {};
        const map = {};
        for (const m of fixture) {
          const t1 = m.t1 || [], t2 = m.t2 || [];
          for (const a of t1) {
            map[a] = map[a] || new Set();
            for (const b of t2) map[a].add(b);
          }
          for (const b of t2) {
            map[b] = map[b] || new Set();
            for (const a of t1) map[b].add(a);
          }
        }
        return Object.fromEntries(Object.entries(map).map(([k, v]) => [k, Array.from(v).sort()]));
      }, [fixture, players]);

      function setScore(week, slot, court, side, value) {
        const key = `${week}-${slot}-${court}`;
        const cur = matches[key] || { t1: 0, t2: 0 };
        const next = { ...cur, [side]: clamp(Number(value) || 0, 0, 32) };
        setMatches({ ...matches, [key]: next });
      }

      function resetAll() {
        if (!confirm("Tüm skorlar ve sonuçlar sıfırlansın mı?")) return;
        if (players) setPoints(Object.fromEntries(players.map((p) => [p, 0])));
        setMatches({});
      }

      return (
        React.createElement("div", { className: "min-h-screen bg-gray-50 text-gray-900" },
          (!players) && React.createElement("div", { className: "max-w-6xl mx-auto px-4 py-6" }, "Oyuncular yükleniyor..."),

          React.createElement("header", { className: "sticky top-0 z-10 bg-white/80 backdrop-blur border-b" },
            React.createElement("div", { className: "max-w-6xl mx-auto px-4 py-4 flex flex-col gap-2 md:flex-row md:items-center md:justify-between" },
              React.createElement("h1", { className: "text-2xl font-bold" }, "Padel Americano — Fixture & Scoreboard"),
              React.createElement("div", { className: "flex items-center gap-3 flex-wrap" },
                React.createElement("div", { className: "text-sm text-gray-600" },
                  "Maç kuralı: ",
                  React.createElement("strong", null, "32'ye kadar"),
                  ", kazanan takımdaki her oyuncuya ",
                  React.createElement("strong", null, "+10"),
                  " bonus."
                ),
                React.createElement("button", { onClick: resetAll, className: "rounded-xl border px-3 py-1.5 text-sm hover:bg-gray-100" }, "Sıfırla"),
                React.createElement("button", { onClick: () => setShowAdmin((v)=>!v), className: "rounded-xl border px-3 py-1.5 text-sm hover:bg-gray-100" }, showAdmin ? "Yönetimi Gizle" : "Yönetim")
              )
            )
          ),

          React.createElement("main", { className: "max-w-6xl mx-auto px-4 py-6 grid gap-8 lg:grid-cols-5" },
            players && React.createElement("section", { className: "lg:col-span-3" },
              React.createElement("div", { className: "mb-3 flex gap-2 flex-wrap items-center" },
                weekList.map((w) => (
                  React.createElement("button", {
                    key: w,
                    onClick: () => setActiveWeek(w),
                    className: "px-3 py-1.5 rounded-xl border text-sm " + (activeWeek === w ? "bg-gray-900 text-white" : "hover:bg-gray-100")
                  }, "Tur ", w)
                )),
                React.createElement("div", { className: "ml-auto flex gap-2 items-center" },
                  React.createElement("label", { className: "text-xs text-gray-600" }, "Slot:"),
                  React.createElement("select", { value: activeSlot, onChange: (e)=> setActiveSlot(e.target.value), className: "rounded-lg border px-2 py-1 text-sm" },
                    React.createElement("option", { value: "all" }, "Tümü"),
                    slotList.map((s)=> React.createElement("option", { key: s, value: String(s) }, s))
                  ),
                  React.createElement("label", { className: "text-xs text-gray-600" }, "Saha:"),
                  React.createElement("select", { value: activeCourt, onChange: (e)=> setActiveCourt(e.target.value), className: "rounded-lg border px-2 py-1 text-sm" },
                    React.createElement("option", { value: "all" }, "Tümü"),
                    (config.courts||[]).map((c)=> React.createElement("option", { key: c, value: c }, c))
                  )
                )
              ),
              React.createElement("div", { className: "grid gap-4" },
                filtered.map((m) => {
                  const k = `${m.week}-${m.slot}-${m.court}`;
                  const rec = matches[k] || { t1: 0, t2: 0 };
                  const t1 = rec.t1 ?? 0;
                  const t2 = rec.t2 ?? 0;
                  const validWinner = (t1 === 32 && t2 <= 31) || (t2 === 32 && t1 <= 31);

                  return React.createElement("div", { key: k, className: "rounded-2xl border bg-white p-4 shadow-sm" },
                    React.createElement("div", { className: "flex items-center justify-between gap-3" },
                      React.createElement("div", { className: "flex items-center gap-2 flex-wrap" },
                        React.createElement("span", { className: "inline-flex items-center rounded-md bg-amber-500 text-gray-900 px-2.5 py-1 text-xs font-semibold" }, "Slot ", m.slot),
                        React.createElement("span", { className: "inline-flex items-center rounded-md bg-emerald-600 text-white px-2.5 py-1 text-xs font-semibold" }, m.court),
                        React.createElement("span", { className: "text-sm text-gray-600" }, "Bekleyen: ", React.createElement("span", { className: "font-semibold text-gray-800" }, m.wait || "-"))
                      ),
                      React.createElement("div", { className: "flex gap-2 text-xs" },
                        React.createElement("span", { className: "inline-flex items-center rounded-full bg-gray-100 px-2 py-1" }, "30 dk")
                      )
                    ),
                    React.createElement("div", { className: "mt-3 grid grid-cols-1 md:grid-cols-2 gap-3" },
                      React.createElement("div", { className: "rounded-xl border p-3 " + (t1 === 32 ? "ring-2 ring-gray-800" : "") },
                        React.createElement("div", { className: "text-xs uppercase tracking-wide text-gray-500" }, "Takım 1"),
                        React.createElement("div", { className: "text-base font-semibold" }, m.t1.join(" & ")),
                        React.createElement("div", { className: "mt-2 flex items-center gap-2" },
                          React.createElement("input", {
                            type: "number", min: 0, max: 32, value: t1,
                            onChange: (e) => setScore(m.week, m.slot, m.court, "t1", e.target.value),
                            onFocus: (e) => e.target.select(),
                            onClick: (e) => e.target.select(),
                            className: "w-24 rounded-lg border px-2 py-1", title: "Takım 1 skoru (0-32)"
                          }),
                          React.createElement("span", { className: "text-xs text-gray-500" }, "/ 32")
                        )
                      ),
                      React.createElement("div", { className: "rounded-xl border p-3 " + (t2 === 32 ? "ring-2 ring-gray-800" : "") },
                        React.createElement("div", { className: "text-xs uppercase tracking-wide text-gray-500" }, "Takım 2"),
                        React.createElement("div", { className: "text-base font-semibold" }, m.t2.join(" & ")),
                        React.createElement("div", { className: "mt-2 flex items-center gap-2" },
                          React.createElement("input", {
                            type: "number", min: 0, max: 32, value: t2,
                            onChange: (e) => setScore(m.week, m.slot, m.court, "t2", e.target.value),
                            onFocus: (e) => e.target.select(),
                            onClick: (e) => e.target.select(),
                            className: "w-24 rounded-lg border px-2 py-1", title: "Takım 2 skoru (0-32)"
                          }),
                          React.createElement("span", { className: "text-xs text-gray-500" }, "/ 32")
                        )
                      )
                    ),
                    (!validWinner) && React.createElement("div", { className: "mt-2 text-xs text-amber-700 bg-amber-50 border border-amber-200 rounded-lg px-2 py-1" },
                      "Geçerli sonuç için: ", React.createElement("strong", null, "bir takım 32"), " olmalı ve diğeri ", React.createElement("strong", null, "≤ 31"), " kalmalı."
                    )
                  );
                })
              )
            ),

            players && React.createElement("section", { className: "lg:col-span-2" },
              React.createElement("div", { className: "rounded-2xl border bg-white p-4 shadow-sm" },
                React.createElement("div", { className: "flex items-end justify-between gap-3" },
                  React.createElement("h2", { className: "text-lg font-semibold" }, "Skor Tablosu"),
                  React.createElement("div", { className: "text-xs text-gray-500" }, "Puanlama: takım skoru + (kazanana kişi başı +10).")
                ),
                React.createElement("div", { className: "mt-4 overflow-x-auto" },
                  React.createElement("table", { className: "w-full text-sm" },
                    React.createElement("thead", null,
                      React.createElement("tr", { className: "text-left text-gray-600" },
                        React.createElement("th", { className: "py-2 pr-4" }, "Oyuncu"),
                        React.createElement("th", { className: "py-2 pr-4" }, "Manuel (+/−)"),
                        React.createElement("th", { className: "py-2 pr-4" }, "Maçlardan"),
                        React.createElement("th", { className: "py-2" }, "Toplam")
                      )
                    ),
                    React.createElement("tbody", null,
                      leaderboard.map((row) => (
                        React.createElement("tr", { key: row.player, className: "border-t" },
                          React.createElement("td", { className: "py-2 pr-4 font-medium" }, row.player),
                          React.createElement("td", { className: "py-2 pr-4" },
                            React.createElement("input", {
                              type: "number", className: "w-24 rounded-lg border px-2 py-1",
                              value: row.manual,
                              onChange: (e) => {
                                const v = Number(e.target.value) || 0;
                                const next = { ...points, [row.player]: v };
                                window.requestAnimationFrame(() => setPoints(next));
                              }
                            })
                          ),
                          React.createElement("td", { className: "py-2 pr-4" }, row.auto),
                          React.createElement("td", { className: "py-2 font-semibold" }, row.total)
                        )
                      ))
                    )
                  )
                )
              ),

              React.createElement("div", { className: "mt-4 grid gap-3" },
                React.createElement("button", {
                  onClick: () => {
                    const payload = { points, matches };
                    const blob = new Blob([JSON.stringify(payload, null, 2)], { type: "application/json" });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement("a");
                    a.href = url;
                    a.download = `americano-score-${new Date().toISOString().slice(0, 10)}.json`;
                    document.body.appendChild(a);
                    a.click();
                    a.remove();
                    URL.revokeObjectURL(url);
                  },
                  className: "rounded-xl border px-3 py-2 text-sm hover:bg-gray-100"
                }, "Verileri Dışa Aktar (JSON)"),
                React.createElement("label", { className: "inline-flex items-center gap-2 text-sm" },
                  React.createElement("span", { className: "rounded-xl border px-3 py-2 hover:bg-gray-100 cursor-pointer" }, "Veri Yükle (JSON)"),
                  React.createElement("input", {
                    type: "file", accept: "application/json", className: "hidden",
                    onChange: async (e) => {
                      const file = e.target.files?.[0];
                      if (!file) return;
                      const text = await file.text();
                      try {
                        const data = JSON.parse(text);
                        if (data.points) setPoints(data.points);
                        if (data.matches) setMatches(data.matches);
                      } catch (err) {
                        alert("Dosya okunamadı. Geçerli bir JSON seçin.");
                      }
                    }
                  })
                )
              )
            ),

            showAdmin && React.createElement("section", { className: "lg:col-span-5" },
              React.createElement("div", { className: "rounded-2xl border bg-white p-4 shadow-sm" },
                React.createElement("div", { className: "flex items-end justify-between gap-3" },
                  React.createElement("h2", { className: "text-lg font-semibold" }, "Yönetim Paneli"),
                  React.createElement("div", { className: "text-xs text-gray-500" }, "Bu değişiklikler localStorage'da saklanabilir; players.json'a yazmak için indirip depoya ekleyin.")
                ),
                React.createElement("div", { className: "mt-4 grid gap-4 md:grid-cols-2" },
                  React.createElement("div", { className: "grid gap-2" },
                    React.createElement("label", { className: "text-sm font-medium" }, "Oyuncular (bir satır = bir oyuncu)"),
                    React.createElement("textarea", { value: plText, onChange: (e) => setPlText(e.target.value), rows: 10, className: "w-full rounded-lg border px-2 py-2" }),
                    React.createElement("div", { className: "flex gap-2 items-center" },
                      React.createElement("input", { type: "text", value: newPlayer, placeholder: "Yeni oyuncu adı", onChange: (e) => setNewPlayer(e.target.value), className: "flex-1 rounded-lg border px-2 py-1" }),
                      React.createElement("button", { className: "rounded-xl border px-3 py-1.5 text-sm hover:bg-gray-100", onClick: () => {
                        const name = (newPlayer || "").trim();
                        if (!name) return;
                        const arr = Array.from(new Set((plText || "").split(/\r?\n/).map(s=>s.trim()).filter(Boolean).concat([name])));
                        setPlText(arr.join("\n"));
                        setNewPlayer("");
                      } }, "Ekle")
                    ),
                    React.createElement("div", { className: "max-h-48 overflow-auto rounded-lg border" },
                      React.createElement("ul", { className: "divide-y" },
                        parsedPlayers.map((p) => (
                          React.createElement("li", { key: p, className: "flex items-center justify-between px-2 py-1.5 text-sm" },
                            React.createElement("span", null, p),
                            React.createElement("button", { className: "text-red-600 hover:underline", onClick: () => {
                              const next = parsedPlayers.filter(x => x !== p);
                              setPlText(next.join("\n"));
                            } }, "Sil")
                          )
                        ))
                      )
                    )
                  ),
                  React.createElement("div", { className: "grid gap-2" },
                    React.createElement("label", { className: "text-sm font-medium" }, "Tur (round) sayısı"),
                    React.createElement("input", { type: "number", min: 1, value: config.weeks, onChange: (e) => setConfig({ ...config, weeks: Math.max(1, Number(e.target.value) || 1) }), className: "w-40 rounded-lg border px-2 py-1" }),
                    React.createElement("label", { className: "text-sm font-medium mt-2" }, "Tur başına slot"),
                    React.createElement("input", { type: "number", min: 1, value: config.slotsPerWeek, onChange: (e) => setConfig({ ...config, slotsPerWeek: Math.max(1, Number(e.target.value) || 1) }), className: "w-40 rounded-lg border px-2 py-1" }),
                    React.createElement("label", { className: "text-sm font-medium mt-2" }, "Saha sayısı"),
                    React.createElement("input", { type: "number", min: 1, value: courtCount, onChange: (e) => {
                      const n = Math.max(1, Number(e.target.value) || 1);
                      setCourtCount(n);
                      const auto = Array.from({ length: n }, (_, i) => `Saha ${i+1}`);
                      setCourtsText(auto.join(", "));
                      setConfig({ ...config, courts: auto });
                    }, className: "w-40 rounded-lg border px-2 py-1" }),
                    React.createElement("label", { className: "text-sm font-medium mt-2" }, "Sahalar (virgülle ayırın)"),
                    React.createElement("input", { type: "text", value: courtsText, onChange: (e) => setCourtsText(e.target.value), className: "w-full rounded-lg border px-2 py-1" })
                  )
                ),
                React.createElement("div", { className: "mt-4 flex flex-wrap gap-2" },
                  React.createElement("button", {
                    className: "rounded-xl border px-3 py-2 text-sm hover:bg-gray-100",
                    onClick: () => {
                      const newPlayers = Array.from(new Set(plText.split(/\r?\n/).map(s => s.trim()).filter(Boolean)));
                      const newCourts = courtsText.split(",").map(s => s.trim()).filter(Boolean);
                      if (newPlayers.length === 0) { alert("En az 1 oyuncu girin."); return; }
                      if (newCourts.length === 0) { alert("En az 1 saha girin."); return; }
                      setPlayers(newPlayers);
                      setConfig((prev) => ({ ...prev, courts: newCourts }));
                      setFixture(generateFixture(newPlayers, config.weeks, config.slotsPerWeek, newCourts));
                      setPoints((prev) => {
                        const next = {};
                        for (const p of newPlayers) next[p] = (prev && prev[p]) || 0;
                        return next;
                      });
                      setMatches({});
                    }
                  }, "Ayarları Uygula (bu oturum)"),
                  React.createElement("button", {
                    className: "rounded-xl border px-3 py-2 text-sm hover:bg-gray-100",
                    onClick: () => {
                      const newPlayers = Array.from(new Set(plText.split(/\r?\n/).map(s => s.trim()).filter(Boolean)));
                      setPlayersOverride(newPlayers);
                      alert("Oyuncu listesi bu cihazda kaydedildi (override). Sayfayı yenilerseniz de bu liste kullanılacak.");
                    }
                  }, "Yerelde Kaydet (override)"),
                  React.createElement("button", {
                    className: "rounded-xl border px-3 py-2 text-sm hover:bg-gray-100",
                    onClick: () => {
                      const data = players || [];
                      const blob = new Blob([JSON.stringify(data, null, 2)], { type: "application/json" });
                      const url = URL.createObjectURL(blob);
                      const a = document.createElement("a");
                      a.href = url; a.download = "players.json";
                      document.body.appendChild(a);
                      a.click(); a.remove();
                      URL.revokeObjectURL(url);
                    }
                  }, "players.json indir"),
                  React.createElement("button", {
                    className: "rounded-xl border px-3 py-2 text-sm hover:bg-gray-100",
                    onClick: () => {
                      const cfg = { weeks: config.weeks, slotsPerWeek: config.slotsPerWeek, courts: courtsText.split(",").map(s=>s.trim()).filter(Boolean) };
                      const blob = new Blob([JSON.stringify(cfg, null, 2)], { type: "application/json" });
                      const url = URL.createObjectURL(blob);
                      const a = document.createElement("a");
                      a.href = url; a.download = "config.json";
                      document.body.appendChild(a);
                      a.click(); a.remove();
                      URL.revokeObjectURL(url);
                    }
                  }, "config.json indir"),
                  React.createElement("button", {
                    className: "rounded-xl border px-3 py-2 text-sm hover:bg-gray-100",
                    onClick: () => {
                      if (!confirm("Yerel override temizlensin ve players.json'a geri dönülsün mü?")) return;
                      try { window.localStorage.removeItem(KEY_PLAYERS_OVERRIDE); } catch (e) {}
                      window.location.reload();
                    }
                  }, "Override'i Temizle")
                ),
                React.createElement("div", { className: "mt-2 flex flex-wrap gap-2" },
                  React.createElement("button", {
                    className: "rounded-xl border px-3 py-2 text-sm hover:bg-gray-100",
                    onClick: () => {
                      if (!confirm("Konfigürasyon (hafta/slot/saha) yerel olarak sıfırlansın mı?")) return;
                      try { window.localStorage.removeItem(KEY_CONFIG); } catch (e) {}
                      window.location.reload();
                    }
                  }, "Config override'ı Temizle")
                ),
                React.createElement("div", { className: "mt-6" },
                  React.createElement("h3", { className: "text-sm font-semibold mb-2" }, "Rakip Çeşitliliği"),
                  players && React.createElement("div", { className: "overflow-x-auto" },
                    React.createElement("table", { className: "w-full text-xs" },
                      React.createElement("thead", null,
                        React.createElement("tr", { className: "text-left text-gray-600" },
                          React.createElement("th", { className: "py-1 pr-3" }, "Oyuncu"),
                          React.createElement("th", { className: "py-1 pr-3" }, "Farklı Rakip Sayısı"),
                          React.createElement("th", { className: "py-1" }, "Liste")
                        )
                      ),
                      React.createElement("tbody", null,
                        players.map((p) => (
                          React.createElement("tr", { key: p, className: "border-t" },
                            React.createElement("td", { className: "py-1 pr-3 font-medium" }, p),
                            React.createElement("td", { className: "py-1 pr-3" }, (uniqueOpponents[p] || []).length || 0),
                            React.createElement("td", { className: "py-1" }, (uniqueOpponents[p] || []).join(", "))
                          )
                        ))
                      )
                    )
                  )
                )
              )
            )
          ),

          React.createElement("footer", { className: "border-t bg-white/60" },
            React.createElement("div", { className: "max-w-6xl mx-auto px-4 py-4 text-xs text-gray-500 flex flex-wrap items-center justify-between gap-2" },
              React.createElement("div", null,
                players
                  ? `Her Çarşamba · 1,5 saat · ${Array.isArray(config && config.courts) ? config.courts.length : 2} saha · her maç 30 dk · ${players && Array.isArray(config && config.courts) ? Math.max(0, players.length - config.courts.length * 4) : Math.max(0, (players ? players.length : 0) - 8)} oyuncu beklemede`
                  : ""
              ),
              React.createElement("div", null, "© Americano Organizer")
            )
          )
        )
      );
    }

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(React.createElement(App));
  </script>
</body>
</html>
